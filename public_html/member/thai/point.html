<!-- 내용 -->
<?
	//페이징 변수
	if (!$start) $start = 0;
	$scale = 10; // 리스트 수
	$page_scale	= 10; // 페이징 수
	$point_ = mysqli_fetch_array(mysqli_query($connect, "SELECT SUM(point) AS total FROM koweb_point WHERE member='$_SESSION[member_id]'"));
?>
<div class="area_shopNumber">
	<em>총 적립된 포인트</em> <i><?=number_format($point_[total])?>점</i>
</div>

<table class="bbsList pointList">
	<caption>적립포인트 내역</caption>
	<colgroup>
		<col style="width:20%"/>
		<col/>
		<col style="width:20%"/>
	</colgroup>
	<thead>
		<tr>
			<th scope="col">날짜</th>
			<th scope="col">적립금내역</th>
			<th scope="col">적립포인트</th>
		</tr>
	</thead>
	<tbody>
		<?
		$query = "SELECT * FROM koweb_point WHERE member = '$_SESSION[member_id]' ORDER BY reg_date DESC LIMIT $start, $scale";
		$total = mysqli_num_rows(mysqli_query($connect, "SELECT * FROM koweb_point WHERE member = '$_SESSION[member_id]'"));
		$result = mysqli_query($connect, $query);

		while($row = mysqli_fetch_array($result)){
		?>
		<tr>
			<td><?=$row[reg_date]?></td>
			<td><a href="/<?=$add_folder?>product/product.html?mode=order_view&orderid=<?=$row[order_id]?>"><?=$row[order_id]?></a> <?=$row[point_type]?></td>
			<!-- 점수가 차감시 span태그에 class="minus" 추가 -->
			<td><span><?=number_format($row[point])?>점</span></td>
		</tr>
		<? } ?>

	</tbody>
</table>

<!-- 페이징 -->
<div class="pagination">
	<?
		/*----------------------------------------------------------------------------*/
		// 페이지 표시
		/*----------------------------------------------------------------------------*/

		if ($total == 0) $total = 1;

		$page_url = "/".$add_folder."member/member.html?mode=point";

		// 처음
		echo "<a href='$page_url&amp;start=0' class='btn_first'><span>맨처음</span></a>";

		$page = floor($start / ($scale * $page_scale));

		if ($start + $scale >  $scale * $page_scale) {
			$pre_start = $start - $scale * $page_scale ;
			echo "<a href='$page_url&amp;start=$pre_start' class='btn_prev'><span>이전</span></a>";
		}

		for ($vj = 0; $vj < $page_scale ; $vj++) {
			$ln = ($page * $page_scale + $vj) * $scale;
			$vk = $page * $page_scale + $vj + 1 ;

			if ($ln < $total) {
				if ($ln != $start) echo "<a href='$page_url&amp;start=$ln'>$vk</a>";
				else echo "<span>$vk</span>";
			}
		}

		// 마지막
		$end_page = floor($total - $scale) + 1;
		if ($end_page <= 0)	$end_page = 0;

		if ($total > (($page + 1) * $scale * $page_scale)) {
			$n_start = ($page + 1) * $scale * $page_scale ;
			echo "<a href='$page_url&amp;start=$n_start' class='btn_next'><span>다음</span></a>";
		}

		$end_page = ceil($total / $scale);
		if ($total) $end_start = ($end_page -1) * $scale;
		else $end_start = $end_page;

		echo "<a href='$page_url&amp;start=$end_start' class='btn_last'><span>맨마지막</span></a>";
	?>
</div>
<!-- //페이징 -->
<!-- //내용 -->
